# Глава 17. Об идеальном коде.

Я писал много хорошего, классного кода. Но намного больше я написал отвратительного кода. Да че там скрывать, наговнокодил за все время так, что Геракл увидев его, сказал бы: "Я пошел обратно грести говно к Авгию...". Такой грех есть у всех за плечами. Конечно, это не мешает нам на собеседованиях спрашивать Code Smells из книги Рефакторинг, и под пивас иногда беседовать про Идеальный Код. Прям сапожник без сапог.

Что ж такое этот идеальный код? И почему, когда мы разгребаем недры чужого проекта, бывают моменты когда мы смотрим, и не можем поверить своим глазам? Это же код Майкрософт, там не можем быть такого? Там же люди проходят на интервью огонь, воду и медные трубы! Там же алгоритмы, и профессионалы с мировым именем! Откуда это говно?!

Жизнь кода программы - это как жизнь человека. Не одев его ботинки, и не пройдя его путь — ты никогда не узнаешь, какого черта он такой засранец. Вот сидишь ты такой, написал кусок кода - он прекрасен. Присмотрелся, допилил, поставил проверочки, выровнял комментарии... Плюнул, и даже добавил в комментарий пример использования своей функции. Посмотрел - ляпотааааа.

Внезапно приходит хотфикс, поменялось направление ветра, Венера зашла в Юпитер, а бекенд вместо строчки возвращает число, и вообще формат поменялся. Хотфикс нужен на вчера, а лучше на позавчера, но обязан быть через 15 минут. И ты лезешь чинить свой кусочек кода путем поставления костылей, заплаток, и немного скотча. Скотч в данном случае 40ка градусный, потому как портишь красоту того самого прекрасного кода. Ты конечно же ставишь комментарий:

// TODO: Correct later

Комитишь код, и за секунду перед пушем у тебя возникает ощущение. Знаете, такое ощущение, когда ты даешь деньги в долг, и понимаешь что они больше никогда к тебе не вернутся. Или когда от тебя уходит твоя девушка, и ты почему—то знаешь, что больше как свою девушку ты ее не увидишь (момент трагедии). Или когда отлучаешься от коллектива поговорить, и понимаешь, что когда ты вернёшься торта уже не будет... Вот и в момент пуша, на долю секунды проскакивает ощущение, что этот твой прекрасный код — прекрасным ты видишь в последний раз.

Потому тебя закидывают заданиями, ты просишь время на технический долг, но менеджмент не сокрушим, и требует все новых и новых фич. И ты создаешь еще одну порцию идеального кода, прекрасного как пятки младенца. Пишешь комментарии, примеры, вылизываешь, и забываешь.

А потом в твой код приходит джун, мидл, да пофиг кто. Вот у него то совсем другое представление о коде, и его красоте. И он берет твой код, и под себя строит. В результате уродует его как Бог утконоса. Естественно, ему надо жить в твоем коде, и получается остатки твоего идеального кода, и куски его идеального кода. И этот Франкенштейн может быть годами.

А бывает что ты уходишь с проекта, и твой код потом уродует какой—то другой человек, и пишет там ересь. А в комментариях твое имя. Вот и карма испорченна. Еще и дурачком каждый кто читает называет.

А бывает мода меняется. И твой прекрасный код вчера, как брюки клёш на мужчине сегодня.

Нет, конечно, чаще всего мы производим код, сомнительного качества. Но толи из—за времени, то ли ревьюверу некогда (если он есть), то ли нам самим лень - жизнь кода начинается как у некрасивого мальчика. Возможно в будущем что—то да изменится, но шансов немного.

Знаете, когда—то 8—9 лет назад я написал наверное свой самый крутой говнокод. Он был настолько отвратителен, что даже фекалоидный монстр преклонил бы перед ним колени. Он кстати делал очень много важного в приложении. Но читать его было совершенно невозможно. Разобраться в разветвлении ifов, глубину падения forов, и страшных переменных. Этот код был не покрыт тестами, он был написан единожды и протестирован методом проб и ошибок. Но в этом коде был один плюс — со своей задачей он справлялся прекрасно, быстро и там не было найдено ни одной ошибки. Я никогда в жизни не писал такой код. Он был пугающе отвратителен и невероятно работоспособный. Так вот, скачав этот продукт с сайта клиента и обдумывая эту статью, поглядел код того модуля который был написан мною. Его никто не трогал. Совсем. Он был все так же похож на Фредди Крюгера, который пробрался к тебе в сон и заставил его дебажить. При чем само приложение обновлялось с завидной постоянностью. И вот он оказался идеальный код, Братюни. 9 лет этот кровоточащий, скрипящий, изрыгающий пламя механизм живет и работает.

Короче, странная эта штука идеальный код. Черт его знает что нужно, чтоб его написать, и какой он должен быть. В любом случае — стремитесь писать красиво.